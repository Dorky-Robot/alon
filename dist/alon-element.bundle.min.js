!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).AlonElement=t()}(this,(function(){"use strict";const e="__AlonEvent__";function t(t,n){const o=new CustomEvent(e,{detail:{...n,__alonSignalDown__:!0},bubbles:!0,cancelable:!0,composed:!0});(function(e){let t=[];function n(e){let o=e.childNodes;0===o.length?e instanceof HTMLElement&&t.push(e):o.forEach((e=>{n(e)}))}return n(e),t})(t).forEach((e=>{e.dispatchEvent(o)}))}function n(e,t){e.stopPropagation();for(const[n,o]of t.entries()){const t=n(e.detail);void 0!==t&&o.forEach((n=>n(t,e)))}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var o={exports:{}};!function(e,t){e.exports=function(){function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e){return l(e)?e:i(o({stylesObject:e}))}const n="__*__";function o({stylesObject:e,parentSelector:t="",cssObject:a={},nestedSelector:i=""}){if(Array.isArray(e)){const[o,s]=e,l=`${r(o)}:${s};`,c=i?a[i]=a[i]||{}:a,u=r(t||n);c[u]=(c[u]||"")+l}else Object.keys(e).forEach((l=>{const c=e[l];if(l.startsWith("@"))o({stylesObject:c,cssObject:a,nestedSelector:l});else if("object"!=typeof c){const e=`${r(l)}:${c};`,o=i?a[i]=a[i]||{}:a,s=r(t||n);o[s]=(o[s]||"")+e}else o({stylesObject:c,parentSelector:s(t,l),cssObject:a,nestedSelector:i})}));return a}function s(e,t){if(!e)return t;const n=a(e),o=a(t);return n.map((e=>o.map((t=>`${e}${t.startsWith(":")?"":" "}${t}`)).join(","))).join(",")}function r(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function a(e){return e.split(",").map((e=>e.trim()))}function i(e){return"object"!=typeof e||Array.isArray(e)||l(e)?e:Object.entries(e).map((([e,t])=>e===n?i(t):`${e}{${i(t)}}`)).join("")}function l(e){return!e||0===Object.keys(e).length}var c={style:t};return e(c)}()}(o);var s=o.exports;const{style:r}=s,a=/\.[^.#]+/g,i=/#[^.#]+/;function l(e){let t={};return e.split(";").forEach((e=>{let[n,o]=e.split(":");n&&o&&(n=n.trim(),n=n.replace(/-./g,(e=>e.charAt(1).toUpperCase())),t[n]=o.trim())})),t}function c(e){if("string"==typeof e)return document.createTextNode(e);if(e instanceof Node)return e;const[t,...n]=e;let o,s={};if("string"!=typeof t)throw new Error("The first element of the habiscript array must be a string.");{o=t.split(/[#.]/)[0];const e=t.match(a),n=t.match(i);e&&(s.class=e.map((e=>e.substring(1))).join(" ")),n&&(s.id=n[0].substring(1))}n.length>0&&"object"==typeof n[0]&&!Array.isArray(n[0])&&Object.assign(s,n.shift());return function(e,t={},n){const o=document.createElement(e);for(const[e,n]of Object.entries(t))if("style"===e&&"object"==typeof n)Object.assign(o.style,n);else if("function"==typeof n&&e.startsWith("on")){const t=e.substring(2).toLowerCase();o.addEventListener(t,n)}else void 0!==n&&o.setAttribute(e,n);for(const e of n)"string"==typeof e?o.appendChild(document.createTextNode(e)):e instanceof Node?o.appendChild(e):Array.isArray(e)&&o.appendChild(c(e));return o}(o,s,n.flatMap((e=>Array.isArray(e)?c(e):e)))}var u={habiToHtml:c,htmlToHabi:function e(t){if("string"==typeof t){return e((new DOMParser).parseFromString(t,"text/html").body.firstChild)}if(t.nodeType===Node.TEXT_NODE)return t.textContent;let n=t.tagName.toLowerCase();t.id&&(n+=`#${t.id}`),t.className&&(n+=`.${t.className.split(" ").join(".")}`);const o=[n],s={};for(const e of t.attributes)"class"!==e.name&&"id"!==e.name&&("style"===e.name?s.style=l(e.value):s[e.name]=e.value);Object.keys(s).length>0&&o.push(s);for(const n of t.childNodes)o.push(e(n));return o},toElement:function(e){return c(e)},style:function(e){return this.toElement(["style",r(e)])}};class f extends HTMLElement{static components=new Set;constructor(){super(),this.shadow=this.attachShadow({mode:"open"})}static register(e){e.name,customElements.define(e.name,e),this.components.add(e)}static toKebabCase(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}isAlon(){return!0}intercept(e,t,n){Alon.intercept(this,e,t,(e=>{n(e)}))}signalUp(t){!function(t,n){t.dispatchEvent(new CustomEvent(e,{detail:{...n,__alonSignalUp__:!0},bubbles:!0,cancelable:!0,composed:!0}))}(this,t)}signalDown(e){t(this,e)}bubbling(t,o){!function(t,o,s){t.alonBubblingHandlers||(t.alonBubblingHandlers=new Map,t.addEventListener(e,(e=>{e.detail.__alonSignalDown__||n(e,t.alonBubblingHandlers)})));const r=t.alonBubblingHandlers.get(o)||[];r.push(s),t.alonBubblingHandlers.set(o,r)}(this,t,o)}capture(t,o){!function(t,o,s){t.alonCaptureHandlers||(t.alonCaptureHandlers=new Map,t.addEventListener(e,(e=>{e.detail.__alonSignalUp__||n(e,t.alonCaptureHandlers)}),!0));const r=t.alonCaptureHandlers.get(o)||[];r.push(s),t.alonCaptureHandlers.set(o,r)}(this,t,o)}html(e){return this.shadow.appendChild(u.toElement(e))}style(e){return this.shadow.appendChild(u.style(e))}}return f}));
